<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="theme-color" content="#121212">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Al Baraka Pure Foods | ‡¶Ü‡¶≤ ‡¶¨‡¶æ‡¶∞‡¶æ‡¶ï‡¶æ ‡¶™‡¶ø‡¶ì‡¶∞ ‡¶´‡ßÅ‡¶°‡¶∏</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
<style>
* { box-sizing: border-box; }
body { font-family: 'Plus Jakarta Sans', 'Hind Siliguri', sans-serif; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; min-height: 100vh; display: flex; flex-direction: column; }
:root {
  --bg-body: #f8fafc; --bg-card: #ffffff; --text-main: #1e293b; --text-sub: #64748b;
  --border-color: #e2e8f0; --primary: #d4af37; --secondary: #1e293b;
}
.dark { --bg-body: #0f172a; --bg-card: #1e293b; --text-main: #f1f5f9; --text-sub: #94a3b8; --border-color: #334155; }
body { background-color: var(--bg-body); color: var(--text-main); transition: background-color 0.3s, color 0.3s; }
.glass { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); border-bottom: 1px solid var(--border-color); }
.dark .glass { background: rgba(15, 23, 42, 0.85); }
.card { background-color: var(--bg-card); border: 1px solid var(--border-color); transition: all 0.2s; border-radius: 1rem; }
.card:hover { border-color: #cbd5e1; }
.dark .card:hover { border-color: #475569; }
.text-muted { color: var(--text-sub); }
.active-view { display: block !important; animation: fadeIn 0.3s ease-in-out; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.safe-bottom { padding-bottom: calc(80px + env(safe-area-inset-bottom)); flex: 1; }
.product-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
@media (min-width: 1024px) { .product-grid { grid-template-columns: repeat(4, 1fr); } }
.btn-primary, .btn-gold, .btn-outline { padding: 0.75rem 1rem; border-radius: 1rem; font-weight: bold; border: none; cursor: pointer; transition: all 0.2s; }
.btn-primary { background-color: var(--secondary); color: white; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
.btn-primary:active { transform: scale(0.98); }
.btn-gold { background-color: var(--primary); color: black; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
.btn-gold:active { transform: scale(0.98); }
.btn-outline { border: 2px solid var(--primary); background: transparent; color: var(--primary); }
.form-input { width: 100%; padding: 0.75rem 1rem; border: 1px solid var(--border-color); border-radius: 0.75rem; background-color: var(--bg-card); color: var(--text-main); font-size: 1rem; }
.form-input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2); }
.nav-bar { position: fixed; bottom: 0; left: 0; right: 0; padding: 0.75rem 0; display: flex; justify-content: space-around; align-items: center; background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); border-top: 1px solid var(--border-color); z-index: 1000; }
.dark .nav-bar { background: rgba(15, 23, 42, 0.85); }
.nav-item { display: flex; flex-direction: column; align-items: center; font-size: 0.75rem; font-weight: bold; color: var(--text-sub); padding: 0.25rem; border-radius: 0.5rem; cursor: pointer; user-select: none; pointer-events: auto; }
.nav-item * { pointer-events: none; }
.nav-item.active { color: var(--primary); }
.nav-icon { width: 1.5rem; height: 1.5rem; margin-bottom: 0.25rem; }
.cart-badge { position: absolute; top: -0.25rem; right: -0.25rem; background-color: #ef4444; color: white; font-size: 0.625rem; width: 1rem; height: 1rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; }
.premium-slider { position: relative; width: 100%; height: 160px; border-radius: 24px; overflow: hidden; margin-bottom: 24px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15); }
.slider-container { display: flex; width: 100%; height: 100%; transition: transform 0.3s ease-in-out; }
.slider-slide { min-width: 100%; height: 100%; position: relative; }
.slider-image { width: 100%; height: 100%; object-fit: cover; }
.slider-overlay { position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent); padding: 20px; color: white; }
.slider-title { font-size: 18px; font-weight: bold; margin-bottom: 4px; color: var(--primary); }
.slider-subtitle { font-size: 12px; opacity: 0.9; }
.slider-dots { position: absolute; bottom: 12px; left: 50%; transform: translateX(-50%); display: flex; gap: 8px; }
.slider-dot { width: 8px; height: 8px; border-radius: 50%; background: rgba(255, 255, 255, 0.5); cursor: pointer; transition: background-color 0.2s; }
.slider-dot.active { background: var(--primary); }
.slider-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0, 0, 0, 0.3); color: white; border: none; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: background-color 0.2s; }
.slider-nav:hover { background: rgba(0, 0, 0, 0.5); }
.slider-prev { left: 12px; }
.slider-next { right: 12px; }
.hidden { display: none !important; }
.full-page-loader { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10000; opacity: 1; transition: opacity 0.3s; }
.full-page-loader.hidden { opacity: 0; pointer-events: none; }
.loader-balls-7 { width: 60px; aspect-ratio: 1; position: relative; --dot-size: 25%; --dot-color: #a7a7a7; --animation-duration: 1.2s; --grd: no-repeat radial-gradient(farthest-side, var(--dot-color) 90%, transparent); background: var(--grd), var(--grd), var(--grd); background-size: var(--dot-size) var(--dot-size); animation: dotMove-7 var(--animation-duration) infinite cubic-bezier(0.3, 0.6, 0.8, 0.5); }
@keyframes dotMove-7 { 0% { background-position: 0% -100%, 50% -100%, 100% -100%; } 16.67% { background-position: 0% 50%, 50% -100%, 100% -100%; } 33.33% { background-position: 0% 50%, 50% 50%, 100% -100%; } 45%, 55% { background-position: 0% 50%, 50% 50%, 100% 50%; } 66.67% { background-position: 0% 200%, 50% 50%, 100% 50%; } 83.33% { background-position: 0% 200%, 50% 200%, 100% 50%; } 100% { background-position: 0% 200%, 50% 200%, 100% 200%; } }
#password-modal { display: none; position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.7); z-index: 1000; align-items: center; justify-content: center; padding: 1rem; }
#password-modal.show { display: flex; }
#daily-banner { position: fixed; inset: 0; z-index: 50; background-color: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; padding: 1rem; }
#daily-banner.hidden { display: none !important; }
.white-card { background: white; border-radius: 12px; padding: 15px; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
.selection-title { text-align: center; font-size: 14px; color: #666; margin-bottom: 15px; }
.method-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
.method-btn { border: 2px solid #eee; border-radius: 10px; padding: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; background: #fff; height: 110px; }
.method-btn svg, .method-btn img { width: 100%; height: 50px; margin-bottom: 8px; object-fit: contain; }
.method-btn span { font-size: 13px; font-weight: bold; color: #555; text-align: center; line-height: 1.2; }
.active-bkash { border-color: #E2136E; background-color: #fff0f6; }
.active-nagad { border-color: #F6921E; background-color: #fffaf0; }
.active-cod { border-color: #2c3e50; background-color: #f4f6f7; }
.payment-card { color: white; border-radius: 12px; padding: 25px 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); min-height: 380px; }
.theme-bkash { background-color: #E2136E; }
.theme-nagad { background: linear-gradient(45deg, #F6921E, #EC1C24); }
.theme-cod { background-color: #2c3e50; }
.trx-input { width: 100%; padding: 15px; border-radius: 8px; border: none; text-align: center; font-size: 18px; margin: 15px 0; color: #333; }
.instruction-list { list-style: none; margin-top: 15px; }
.instruction-list li { padding: 8px 0; border-top: 1px solid rgba(255, 255, 255, 0.2); font-size: 14px; }
.copy-wrapper { display: flex; align-items: center; gap: 10px; background: rgba(0,0,0,0.2); padding: 8px 15px; border-radius: 5px; margin-top: 5px; width: fit-content; }
.verify-btn { width: 100%; padding: 15px; background: white; border: none; font-weight: bold; border-radius: 8px; margin-top: 20px; cursor: pointer; font-size: 16px; }
#toast { visibility: hidden; background-color: #333; color: #fff; padding: 12px 25px; border-radius: 50px; position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 100; }
#toast.show { visibility: visible; }
.social-icon { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; text-decoration: none; transition: transform 0.2s; }
.social-icon:hover { transform: scale(1.1); }
.facebook { background-color: #1877f2; }
.instagram { background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888); }
.youtube { background-color: #ff0000; }
@media (max-width: 768px) { .premium-slider { height: 140px; } .slider-title { font-size: 16px; } .slider-subtitle { font-size: 11px; } }
</style>
</head>
<body id="main-body">

<div id="daily-banner" class="hidden">
  <div class="relative w-full max-w-[360px] aspect-[4/5] rounded-2xl overflow-hidden shadow-2xl bg-white">
    <button id="banner-close" class="absolute top-2.5 right-2.5 z-20 w-8 h-8 flex items-center justify-center bg-black/40 text-white rounded-full text-base font-bold hover:bg-black/60 transition">‚úï</button>
    <img id="daily-banner-image" src="" alt="Special Offer" class="w-full h-full object-cover">
  </div>
</div>

<header class="sticky top-0 z-50 glass px-5 py-4 flex justify-between items-center">
<h2 class="text-[#d4af37] font-extrabold text-xl tracking-tight">Al Baraka Pure Foods</h2>
<div id="auth-status" class="text-[10px] bg-[#e2e8f0] text-[#64748b] px-3 py-1 rounded-full font-bold uppercase tracking-wider">Login Required</div>
</header>

<main class="safe-bottom">
<section id="view-signup" class="view hidden auth-view px-4 pt-4">
<div class="max-w-md mx-auto">
<h2 class="text-2xl font-extrabold text-center mb-8">Create Your Account</h2>
<div class="space-y-4">
<input type="text" id="signup-name" placeholder="Enter your full name" class="form-input w-full">
<input type="email" id="signup-email" placeholder="Enter your email" class="form-input w-full">
<input type="tel" id="signup-phone" placeholder="+880 1XXX XXX XXX" class="form-input w-full">
<input type="password" id="signup-password" placeholder="Create a password" class="form-input w-full">
<input type="password" id="signup-confirm-password" placeholder="Confirm your password" class="form-input w-full">
<button id="signup-submit" class="btn-primary w-full mt-6">Create Account</button>
<p class="text-center text-sm text-muted">Already have an account? <a href="#" id="go-to-login" class="text-[#d4af37] font-medium">Log in</a></p>
</div>
</div>
</section>

<section id="view-login" class="view hidden auth-view px-4 pt-4">
<div class="max-w-md mx-auto">
<h2 class="text-2xl font-extrabold text-center mb-8">Welcome Back</h2>
<div class="space-y-4">
<input type="email" id="login-email" placeholder="Enter your email" class="form-input w-full">
<input type="password" id="login-password" placeholder="Enter your password" class="form-input w-full">
<button id="login-submit" class="btn-primary w-full mt-6">Sign In</button>
<p class="text-center text-sm text-muted">Don't have an account? <a href="#" id="go-to-signup" class="text-[#d4af37] font-medium">Sign up</a></p>
</div>
</div>
</section>

<section id="view-home" class="view active-view px-4 pt-4">
<input type="text" id="search-input" placeholder="‡¶™‡¶£‡ßç‡¶Ø ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®..." class="form-input w-full shadow-sm focus:ring-2 focus:ring-[#d4af37] mb-6">
<div class="premium-slider">
<div class="slider-container" id="slider-container">
<div class="slider-slide">
<img src="https://images.unsplash.com/photo-1565299507177-b0ac66763828?w=800&auto=format&fit=crop" class="slider-image">
<div class="slider-overlay">
<div class="slider-title">‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ ‡¶ï‡¶æ‡¶≤‡ßá‡¶ï‡¶∂‡¶®</div>
<div class="slider-subtitle">‡¶∏‡ßÄ‡¶Æ‡¶ø‡¶§ ‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá‡¶∞ ‡¶Ö‡¶´‡¶æ‡¶∞</div>
</div>
</div>
</div>
<div class="slider-dots" id="slider-dots"><div class="slider-dot active" data-index="0"></div></div>
<button class="slider-nav slider-prev" id="slider-prev">‚Äπ</button>
<button class="slider-nav slider-next" id="slider-next">‚Ä∫</button>
</div>
<h4 class="font-bold text-lg mb-4">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡ßá‡¶∞‡¶æ</h4>
<div class="product-grid" id="product-container"><div class="text-center py-10">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div></div>
</section>

<section id="view-detail" class="view hidden px-5 pt-4">
<button id="back-to-home" class="mb-4 text-muted font-bold flex items-center">‚Üê ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®</button>
<div id="detail-content"></div>
</section>

<section id="view-cart" class="view hidden px-5 pt-4">
<h2 class="text-2xl font-extrabold mb-6">‡¶∂‡¶™‡¶ø‡¶Ç ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ó</h2>
<div id="cart-items" class="space-y-4"></div>
<div id="cart-summary" class="hidden mt-8 pt-6 border-t border-[var(--border-color)]">
<div class="flex justify-between text-lg font-bold mb-6">
<span>‡¶Æ‡ßã‡¶ü ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</span>
<span>‡ß≥<span id="cart-total">0</span></span>
</div>
<button id="go-to-payment" class="btn-gold w-full">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>
<div id="cart-empty" class="text-center py-20">
<p class="text-muted">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ó ‡¶ñ‡¶æ‡¶≤‡¶ø</p>
<button id="start-shopping" class="text-[#d4af37] font-bold mt-2">‡¶ï‡ßá‡¶®‡¶æ‡¶ï‡¶æ‡¶ü‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>
</section>

<section id="view-delivery-alert" class="view hidden px-5 pt-4">
<div class="card p-6 rounded-3xl shadow-sm text-center">
<h3 class="text-xl font-extrabold mb-4 text-red-600">‚ö†Ô∏è ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶®‡ßã‡¶ü</h3>
<p class="text-muted mb-6" id="delivery-note-content"></p>
<button id="btn-proceed-to-payment" class="btn-primary w-full">‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá, ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>
</section>

<section id="view-payment-method" class="view hidden px-4 pt-4 pb-20">
<div class="container max-w-[450px] mx-auto">
<div class="white-card">
<div class="selection-title">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Æ‡ßá‡¶•‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</div>
<div class="method-grid">
<div class="method-btn active-bkash" onclick="switchMethod('bkash')" id="btn-bkash">
<svg viewBox="-18.0015 -28.3525 156.013 170.115"><path fill="#E2136E" d="M96.58 62.45L56.62 6.93 43.56 54.15z"/></svg>
<span>‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂</span>
</div>
<div class="method-btn" onclick="switchMethod('nagad')" id="btn-nagad">
<svg viewBox="0 0 90 130" preserveAspectRatio="xMidYMid meet"><path fill="#ec1c24" d="M29.9 79.2H.9c-.5 0-.9.4-.9.9v2.2c0 .5.4.9.9.9h21.5v11.9"/></svg>
<span>‡¶®‡¶ó‡¶¶</span>
</div>
<div class="method-btn" onclick="switchMethod('cod')" id="btn-cod">
<svg viewBox="0 0 24 24" fill="none" stroke="#2c3e50" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
<span>‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶Ö‡¶® ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø</span>
</div>
</div>
</div>
<div class="payment-card theme-bkash" id="mainCard">
<div id="paymentContent"></div>
<button class="verify-btn" onclick="handleAction()" id="actionBtn" style="color: #E2136E;">‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶æ‡¶á ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>
</div>
</section>

<section id="view-payment-info" class="view hidden px-5 pt-4">
<button id="back-to-payment-method" class="text-muted font-bold flex items-center mb-6">‚Üê ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡¶¶‡ßç‡¶ß‡¶§‡¶ø</button>
<div class="card p-5 rounded-3xl shadow-sm">
<h3 class="text-xl font-extrabold mb-4">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶æ‡¶¨‡¶≤‡ßÄ</h3>
<div class="space-y-6">
<div>
<h4 class="font-bold text-lg mb-2 text-[#d4af37]">bKash ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü</h4>
<ul class="list-disc pl-5 space-y-2 text-muted text-sm">
<li>*247# ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®</li>
<li>"Payment" ‡¶Ö‡¶™‡¶∂‡¶® ‡¶¨‡ßá‡¶õ‡ßá ‡¶®‡¶ø‡¶®</li>
<li>Merchant ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞: <strong id="bkash-number-display">017XXXXXXXX</strong></li>
<li>Transaction ID ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®</li>
</ul>
</div>
<div>
<h4 class="font-bold text-lg mb-2 text-[#d4af37]">Nagad ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü</h4>
<ul class="list-disc pl-5 space-y-2 text-muted text-sm">
<li>*167# ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®</li>
<li>"Send Money" ‡¶Ö‡¶™‡¶∂‡¶® ‡¶¨‡ßá‡¶õ‡ßá ‡¶®‡¶ø‡¶®</li>
<li>Nagad ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞: <strong id="nagad-number-display">017XXXXXXXX</strong></li>
<li>Transaction ID ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®</li>
</ul>
</div>
</div>
<button id="continue-to-checkout" class="btn-primary w-full mt-6">Checkout ‡¶è ‡¶Ø‡¶æ‡¶®</button>
</div>
</section>

<section id="view-checkout" class="view hidden px-5 pt-4">
<button id="back-to-payment-info" class="text-muted font-bold flex items-center mb-6">‚Üê ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶§‡¶•‡ßç‡¶Ø</button>
<h2 class="text-xl font-extrabold mb-6">‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶§‡¶•‡ßç‡¶Ø</h2>
<div class="space-y-4 card p-5 rounded-3xl shadow-sm mb-6">
<input type="text" id="order-name" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ" class="form-input bg-transparent border-b-0">
<input type="text" id="order-phone" placeholder="‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞" class="form-input bg-transparent border-b-0">
<textarea id="order-address" placeholder="‡¶™‡ßÅ‡¶∞‡ßã ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ" class="form-input bg-transparent border-b-0 h-20 resize-none"></textarea>
</div>
<div class="mt-6 p-4 bg-[#f1f5f9] dark:bg-[#334155] rounded-2xl flex justify-between items-center mb-6">
<div><p class="text-xs text-muted">Payment Method</p><p class="font-bold text-lg" id="confirm-payment-display">COD</p></div>
<div class="text-right"><p class="text-xs text-muted">‡¶Æ‡ßã‡¶ü ‡¶ü‡¶æ‡¶ï‡¶æ</p><p class="font-bold text-lg text-[#d4af37]">‡ß≥<span id="confirm-total-display">0</span></p></div>
</div>
<button id="submit-order" class="btn-gold w-full">‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</section>

<section id="view-account" class="view hidden px-5 pt-4 pb-20">
<div id="account-guest-view" class="text-center py-16 hidden">
<h3 class="text-xl font-bold mb-3">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü</h3>
<p class="text-muted mb-6">‡¶≤‡¶ó ‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶ñ‡ßÅ‡¶≤‡ßÅ‡¶®‡•§</p>
<div class="flex gap-3 max-w-xs mx-auto">
<button id="go-to-login-from-account" class="btn-outline flex-1 py-2 text-sm">‡¶≤‡¶ó ‡¶á‡¶®</button>
<button id="go-to-signup-from-account" class="btn-primary flex-1 py-2 text-sm">‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™</button>
</div>
</div>

<div id="account-user-view" class="hidden">
<div class="relative overflow-hidden rounded-3xl bg-[#1e293b] p-6 mb-6 shadow-xl text-white">
<div class="flex items-center gap-4 mb-4">
<div class="w-16 h-16 rounded-full bg-[#d4af37] flex items-center justify-center text-2xl font-bold" id="avatar">U</div>
<h3 class="font-bold text-lg" id="user-email-display">user@example.com</h3>
</div>
<div class="grid grid-cols-4 gap-2 text-center text-sm">
<div><div class="font-bold text-[#d4af37]" id="stat-orders">0</div><div class="text-[10px] text-gray-400">‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞</div></div>
<div><div class="font-bold text-[#d4af37]" id="stat-pending">0</div><div class="text-[10px] text-gray-400">‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç</div></div>
<div><div class="font-bold text-[#d4af37]">‡ß≥<span id="stat-spent">0</span></div><div class="text-[10px] text-gray-400">‡¶ñ‡¶∞‡¶ö</div></div>
<div><div class="font-bold text-[#d4af37]" id="account-name">User</div><div class*text-[10px] text-gray-400">‡¶®‡¶æ‡¶Æ</div></div>
</div>
</div>

<div class="card p-5 rounded-3xl shadow-sm mb-6">
<h4 class="font-bold text-lg mb-4">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</h4>
<div class="space-y-4">
<input type="text" id="profile-name" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ" class="form-input">
<input type="tel" id="profile-phone" placeholder="‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞" class="form-input">
<textarea id="profile-address" placeholder="‡¶™‡ßÅ‡¶∞‡ßã ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ" class="form-input h-20 resize-none"></textarea>
<div class="grid grid-cols-2 gap-3">
<button id="update-profile-btn" class="btn-primary py-2 text-sm">‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü</button>
<button id="change-password-btn" class="btn-outline py-2 text-sm">‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®</button>
</div>
</div>
</div>

<div id="password-modal" class="hidden">
<div class="bg-white dark:bg-[#1e293b] rounded-2xl w-full max-w-md p-6">
<h4 class="font-bold text-lg mb-4">‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h4>
<div class="space-y-4">
<input type="password" id="old-pass" placeholder="‡¶™‡ßÅ‡¶∞‡¶æ‡¶®‡ßã ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°" class="form-input">
<input type="password" id="new-pass" placeholder="‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°" class="form-input">
<input type="password" id="confirm-pass" placeholder="‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®" class="form-input">
</div>
<div class="flex gap-3 mt-6">
<button id="cancel-password-btn" class="flex-1 btn-outline py-2">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
<button id="save-password-btn" class="flex-1 btn-primary py-2">‡¶Ü‡¶™‡¶°‡ßá‡¶ü</button>
</div>
</div>
</div>

<div class="grid grid-cols-2 gap-3 mb-8">
<button id="go-to-support-btn" class="flex flex-col items-center justify-center p-4 card rounded-2xl hover:bg-[#f1f5f9] dark:hover:bg-[#334155]">
<div class="w-10 h-10 bg-[#dbeafe] dark:bg-[#1e3a8a] rounded-full flex items-center justify-center text-[#1d4ed8] mb-2">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192L5.636 18.364M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
</div>
<span class="text-xs font-bold">‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</span>
</button>
<button id="toggle-theme-btn" class="flex flex-col items-center justify-center p-4 card rounded-2xl hover:bg-[#f1f5f9] dark:hover:bg-[#334155]">
<div class="w-10 h-10 bg-[#e2e8f0] dark:bg-[#475569] rounded-full flex items-center justify-center text-[#64748b] mb-2">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
</div>
<span class="text-xs font-bold">‡¶•‡¶ø‡¶Æ</span>
</button>
</div>

<div class="flex justify-between items-end mb-4">
<h4 class="font-bold text-lg">‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø</h4>
<button id="refresh-orders-btn" class="text-xs text-[#d4af37] font-bold">‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂</button>
</div>
<div id="order-list" class="space-y-3 max-h-[400px] overflow-y-auto pb-4"></div>
<button id="logout-btn" class="w-full mt-6 border border-[#fee2e2] dark:border-[#7f1d1d] bg-[#fef2f2] dark:bg-[#450a0a] text-red-500 py-3 rounded-2xl font-bold">‡¶≤‡¶ó ‡¶Ü‡¶â‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>
</section>

<section id="view-notes" class="view hidden px-5 pt-4">
<h2 class="text-xl font-bold mb-4">Notes</h2>
<div class="text-sm text-muted space-y-4" id="notes-content"></div>
</section>

<section id="view-support" class="view hidden px-5 pt-4">
<h2 class="text-2xl font-extrabold mb-6">‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</h2>
<div class="card p-5 rounded-3xl shadow-sm mb-6">
<h4 class="font-bold text-lg mb-4">‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏</h4>
<div class="space-y-3">
<div class="flex items-center gap-3">
<svg class="w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 24 24"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.24 1.02l-2.2 2.2z"/></svg>
<span>WhatsApp: <a href="https://wa.me/8801XXXXXXXXX" target="_blank" class="text-[#d4af37]">+8801XXXXXXXXX</a></span>
</div>
<div class="flex items-center gap-3">
<svg class="w-5 h-5 text-blue-500" fill="currentColor" viewBox="0 0 24 24"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.24 1.02l-2.2 2.2z"/></svg>
<span>‡¶´‡ßã‡¶®: <a href="tel:+8801XXXXXXXXX" class="text-[#d4af37]">+8801XXXXXXXXX</a></span>
</div>
<div class="flex items-center gap-3">
<svg class="w-5 h-5 text-red-500" fill="currentColor" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
<span>‡¶á‡¶Æ‡ßá‡¶á‡¶≤: <a href="mailto:info@albarakafoods.com" class="text-[#d4af37]">info@albarakafoods.com</a></span>
</div>
</div>
</div>
<div class="card p-5 rounded-3xl shadow-sm mb-6">
<h4 class="font-bold text-lg mb-4">Follow Us</h4>
<div class="flex justify-center gap-4">
<a href="https://facebook.com/albarakafoods" target="_blank" class="social-icon facebook">f</a>
<a href="https://instagram.com/albarakafoods" target="_blank" class="social-icon instagram">i</a>
<a href="https://youtube.com/@albarakafoods" target="_blank" class="social-icon youtube">Y</a>
</div>
</div>
<div class="text-sm text-muted space-y-3" id="support-content"></div>
</section>
</main>

<nav class="nav-bar" id="main-nav">
<div id="nav-home" class="nav-item active">
<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
<span>‡¶π‡ßã‡¶Æ</span>
</div>
<div id="nav-cart" class="nav-item">
<div class="relative">
<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
<span id="cart-badge" class="cart-badge">0</span>
</div>
<span>‡¶ï‡¶æ‡¶∞‡ßç‡¶ü</span>
</div>
<div id="nav-account" class="nav-item">
<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
<span>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü</span>
</div>
<div id="nav-notes" class="nav-item">
<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
<span>Notes</span>
</div>
</nav>

<div id="full-page-loader" class="full-page-loader">
<div class="loader-balls-7"></div>
</div>

<div id="toast">‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!</div>

<script>
const fbConfig = {
  apiKey: "AIzaSyBdPXCZBkr-CLi4KigcyzlXBRUT14ony54",
  databaseURL: "https://tornament-bc970-default-rtdb.firebaseio.com",
  projectId: "tornament-bc970",
  appId: "1:367280660705:web:5132bf02d12159e88b97a0"
};

let app, auth, db, firebaseInitialized = false, sliderInterval = null, currentSlideIndex = 0;
let paymentNumbers = { bkash: '017XXXXXXXX', nagad: '017XXXXXXXX' };
let cart = JSON.parse(localStorage.getItem('alb_cart')) || [];
let selectedMethod = null, products = [], premiumSlides = [];
let contentConfig = {
  notesContent: '',
  deliveryNote: '‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶¢‡¶æ‡¶ï‡¶æ ‡¶Æ‡¶π‡¶æ‡¶®‡¶ó‡¶∞ ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶Ø‡¶º ‡¶∏‡ßÄ‡¶Æ‡¶æ‡¶¨‡¶¶‡ßç‡¶ß‡•§\n‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶Ø‡¶º ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø ‡¶®‡¶Ø‡¶º‡•§',
  supportContent: '‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶Æ‡¶Ø‡¶º‡•§ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú‡ßá‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶¨‡ßá 24 ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá‡•§'
};
let dailyBannerData = { enabled: false, imageUrl: '' };

try {
  if (!firebase.apps.length) {
    app = firebase.initializeApp(fbConfig);
  } else {
    app = firebase.app();
  }
  firebaseInitialized = true;
  auth = firebase.auth();
  db = firebase.database();
} catch (error) {
  console.error('Firebase init error:', error);
  firebaseInitialized = false;
}

const el = (id) => document.getElementById(id);
const showLoader = () => el('full-page-loader')?.classList.remove('hidden');
const hideLoader = () => el('full-page-loader')?.classList.add('hidden');

async function loadPaymentNumbers() {
  try {
    if (firebaseInitialized) {
      const snap = await db.ref('config/paymentNumbers').once('value');
      const data = snap.val() || {};
      if (data.bkash) paymentNumbers.bkash = data.bkash;
      if (data.nagad) paymentNumbers.nagad = data.nagad;
    }
  } catch (e) { console.error('Payment numbers error:', e); }
  updatePaymentUI();
}

async function loadContentConfig() {
  try {
    if (firebaseInitialized) {
      const snap = await db.ref('config/content').once('value');
      const data = snap.val() || {};
      contentConfig.notesContent = data.notesContent || contentConfig.notesContent;
      contentConfig.deliveryNote = data.deliveryNote || contentConfig.deliveryNote;
      contentConfig.supportContent = data.supportContent || contentConfig.supportContent;
    }
  } catch (e) { console.error('Content config error:', e); }
}

function updatePaymentUI() {
  const nums = { 'bkash-number-display': paymentNumbers.bkash, 'nagad-number-display': paymentNumbers.nagad };
  Object.entries(nums).forEach(([id, val]) => {
    if(el(id)) el(id).innerText = val;
  });
  if(el('agentNumber')) el('agentNumber').innerText = selectedMethod === 'nagad' ? paymentNumbers.nagad : paymentNumbers.bkash;
}

async function loadProductsFromFirebase() {
  try {
    if (firebaseInitialized) {
      const snap = await db.ref('products').once('value');
      products = snap.exists() ? Object.entries(snap.val() || {}).map(([k, v]) => ({id: k, ...v})) : [];
    }
    if (products.length === 0) products = [
      { id: '1', title: 'Premium Storage Jar', price: 450, img: 'https://images.unsplash.com/photo-1534073828943-f801091bb18c?w=400', desc: '‡ß´‡ß¶‡ß¶ ‡¶Æ‡¶ø‡¶≤‡¶ø ‡¶ß‡¶æ‡¶∞‡¶£‡¶ï‡ßç‡¶∑‡¶Æ‡¶§‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶è‡¶Ø‡¶º‡¶æ‡¶∞‡¶ü‡¶æ‡¶á‡¶ü ‡¶ï‡¶æ‡¶Å‡¶ö‡ßá‡¶∞ ‡¶ú‡¶æ‡¶∞‡•§' },
      { id: '2', title: 'Eco Canvas Bag', price: 280, img: 'https://images.unsplash.com/photo-1544816155-12df9643f363?w=400', desc: '‡¶™‡¶∞‡¶ø‡¶¨‡ßá‡¶∂‡¶¨‡¶æ‡¶®‡ßç‡¶ß‡¶¨ ‡ßß‡ß¶‡ß¶% ‡¶ï‡¶ü‡¶® ‡¶ï‡ßç‡¶Ø‡¶æ‡¶®‡¶≠‡¶æ‡¶∏ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ó‡•§' },
      { id: '3', title: 'Luxury Gift Box', price: 1200, img: 'https://images.unsplash.com/photo-1549465220-1a8b9238cd48?w=400', desc: '‡¶π‡¶æ‡¶§‡ßá ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶æ‡¶†‡ßá‡¶∞ ‡¶≤‡¶æ‡¶ï‡ßç‡¶∏‡¶æ‡¶∞‡¶ø ‡¶¨‡¶ï‡ßç‡¶∏‡•§' },
      { id: '4', title: 'Natural Bamboo Tray', price: 650, img: 'https://images.unsplash.com/photo-1596461404969-9ae70f2830c1?w=400', desc: '‡¶™‡ßç‡¶∞‡¶æ‡¶ï‡ßÉ‡¶§‡¶ø‡¶ï ‡¶¨‡¶æ‡¶Å‡¶∂ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶§‡ßà‡¶∞‡¶ø ‡¶ü‡ßç‡¶∞‡ßá‡•§' }
    ];
  } catch (e) { console.error('Products error:', e); }
  renderProducts();
}

async function loadPremiumSliderData() {
  try {
    if (firebaseInitialized) {
      const snap = await db.ref('config/premiumSlider').once('value');
      if (snap.val()?.enabled) premiumSlides = snap.val().slides || [];
    }
  } catch (e) { console.log('Slider error:', e); }
  if (premiumSlides.length === 0) premiumSlides = [{
    image: "https://images.unsplash.com/photo-1565299507177-b0ac66763828?w=800&auto=format&fit=crop",
    title: "‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ ‡¶ï‡¶æ‡¶≤‡ßá‡¶ï‡¶∂‡¶®",
    subtitle: "‡¶∏‡ßÄ‡¶Æ‡¶ø‡¶§ ‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá‡¶∞ ‡¶Ö‡¶´‡¶æ‡¶∞"
  }];
}

async function loadDailyBanner() {
  try {
    if (firebaseInitialized) {
      const snap = await db.ref('config/dailyBanner').once('value');
      dailyBannerData = snap.val() || { enabled: false };
      const banner = el('daily-banner');
      if (dailyBannerData.enabled && dailyBannerData.imageUrl) {
        el('daily-banner-image').src = dailyBannerData.imageUrl;
        banner?.classList.remove('hidden');
      } else {
        banner?.classList.add('hidden');
      }
    }
  } catch (e) { console.error('Banner error:', e); }
}

function renderNotes() { if(el('notes-content')) el('notes-content').innerHTML = contentConfig.notesContent.split('\n').map(l => l.trim() ? `<p>${l}</p>` : '').join(''); }
function renderDeliveryNote() { if(el('delivery-note-content')) el('delivery-note-content').innerHTML = contentConfig.deliveryNote.split('\n').map(l => l.trim() ? `<span>${l}</span><br>` : '').join(''); }
function renderSupportContent() { if(el('support-content')) el('support-content').innerHTML = contentConfig.supportContent.split('\n').map(l => l.trim() ? `<p>${l}</p>` : '').join(''); }

document.addEventListener('DOMContentLoaded', async function() {
  showLoader();
  try {
    await Promise.all([loadPaymentNumbers(), loadProductsFromFirebase(), loadPremiumSliderData(), loadDailyBanner(), loadContentConfig()]);
    setupEventListeners();
    initPremiumSlider();
    syncCart();
    if (firebaseInitialized) {
      auth.onAuthStateChanged(user => {
        if(el('auth-status')) el('auth-status').innerText = user ? "Logged In" : "Login Required";
      });
    }
    renderNotes();
    renderDeliveryNote();
    renderSupportContent();
  } catch (e) {
    console.error("Startup error:", e);
    alert("App startup failed. Check internet connection.");
  } finally {
    hideLoader();
  }
});

function setupEventListeners() {
  const navs = ['home', 'cart', 'account', 'notes'];
  navs.forEach(n => el(`nav-${n}`)?.addEventListener('click', () => {
    changeView(`view-${n}`);
    if(n === 'account') checkAccountView();
  }));

  const btns = {
    'go-to-signup': () => changeView('view-signup'),
    'go-to-login': () => changeView('view-login'),
    'go-to-login-from-account': () => changeView('view-login'),
    'go-to-signup-from-account': () => changeView('view-signup'),
    'signup-submit': handleSignup,
    'login-submit': handleLogin,
    'back-to-home': () => changeView('view-home'),
    'start-shopping': () => changeView('view-home'),
    'go-to-payment': goToPayment,
    'btn-proceed-to-payment': () => changeView('view-payment-method'),
    'continue-to-checkout': () => { populateCheckoutForm(); changeView('view-checkout'); },
    'back-to-payment-method': () => changeView('view-payment-method'),
    'back-to-payment-info': () => changeView('view-payment-info'),
    'submit-order': submitOrderHandler,
    'update-profile-btn': updateProfile,
    'change-password-btn': showChangePassword,
    'cancel-password-btn': hideChangePassword,
    'save-password-btn': changePassword,
    'go-to-support-btn': () => changeView('view-support'),
    'toggle-theme-btn': toggleTheme,
    'refresh-orders-btn': () => { if(auth.currentUser) loadOrders(auth.currentUser.email); },
    'logout-btn': logout,
    'banner-close': () => el('daily-banner').classList.add('hidden'),
    'slider-prev': goToPrevSlide,
    'slider-next': goToNextSlide
  };
  Object.entries(btns).forEach(([id, fn]) => {
    if(el(id)) el(id).onclick = (e) => { e.preventDefault?.(); fn(); };
  });

  document.addEventListener('input', e => { if(e.target.id === 'trxID') validatePaymentButton(); });
  document.addEventListener('click', e => {
    if(e.target.closest('.product-item') && !e.target.closest('.add-to-cart-btn')) openProduct(e.target.closest('.product-item').dataset.id);
    if(e.target.classList.contains('add-to-cart-btn') || e.target.classList.contains('add-to-cart-detail-btn')) addToCart(e.target.dataset.id);
    if(e.target.classList.contains('remove-item-btn')) removeItem(parseInt(e.target.dataset.index));
    if(e.target.classList.contains('slider-dot')) goToSlide(parseInt(e.target.dataset.index));
  });
}

function goToPayment() {
  if(firebaseInitialized && auth.currentUser) changeView('view-delivery-alert');
  else { alert("‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶§‡ßá ‡¶≤‡¶ó ‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®"); changeView('view-login'); }
}

function changeView(viewId) {
  document.querySelectorAll('.view').forEach(v => { v.classList.add('hidden'); v.classList.remove('active-view'); });
  const target = el(viewId);
  if(target) { target.classList.remove('hidden'); target.classList.add('active-view'); }

  document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
  const navMap = { 'view-home': 'nav-home', 'view-cart': 'nav-cart', 'view-account': 'nav-account', 'view-support': 'nav-account', 'view-notes': 'nav-notes', 'view-signup': 'nav-account', 'view-login': 'nav-account' };
  if(navMap[viewId]) el(navMap[viewId]).classList.add('active');

  const mainNav = el('main-nav');
  if(['view-signup', 'view-login'].includes(viewId)) {
    mainNav.style.display = 'none';
    document.body.classList.add('no-nav');
  } else {
    mainNav.style.display = 'flex';
    document.body.classList.remove('no-nav');
  }

  if(viewId === 'view-payment-method') resetPaymentSelection();
  window.scrollTo({top: 0, behavior: 'smooth'});
}

function resetPaymentSelection() {
  selectedMethod = 'bkash';
  const total = cart.reduce((s, p) => s + p.price, 0);
  switchMethod('bkash', total);
}

function switchMethod(m, amount) {
  selectedMethod = m;
  ['bkash', 'nagad', 'cod'].forEach(x => el(`btn-${x}`).classList.remove(`active-${x}`));
  el(`btn-${m}`).classList.add(`active-${m}`);

  const card = el('mainCard');
  const btn = el('actionBtn');
  const colors = { bkash: '#E2136E', nagad: '#EC1C24', cod: '#2c3e50' };
  card.className = `payment-card theme-${m}`;
  btn.style.color = colors[m];

  const totalAmount = amount || cart.reduce((s, p) => s + p.price, 0);
  const content = el('paymentContent');

  if(m === 'cod') {
    btn.innerText = '‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡ßÅ‡¶®';
    content.innerHTML = `<div style="text-align: center; margin-bottom: 20px;"><h2 style="margin-bottom:10px;">üöö ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ</h2><p>‡¶™‡¶£‡ßç‡¶Ø ‡¶π‡¶æ‡¶§‡ßá ‡¶™‡ßá‡¶Ø‡¶º‡ßá ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p></div><ul class="instruction-list"><li>‡ßß. ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</li><li>‡ß®. ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶®‡¶ø‡¶ß‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶¨‡ßá‡•§</li><li>‡ß©. ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶ö‡¶æ‡¶∞‡ßç‡¶ú ‡¶è‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ ‡¶≠‡ßá‡¶¶‡ßá ‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§</li><li>‡ß™. ‡¶™‡¶£‡ßç‡¶Ø ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá ‡¶¨‡ßÅ‡¶ù‡ßá ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡ßÅ‡¶Ø‡ßã‡¶ó ‡¶•‡¶æ‡¶ï‡¶¨‡ßá‡•§</li></ul>`;
  } else {
    btn.innerText = '‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶æ‡¶á ‡¶ï‡¶∞‡ßÅ‡¶®';
    const dialCode = m === 'bkash' ? '*247#' : '*167#';
    const merchantNum = m === 'bkash' ? paymentNumbers.bkash : paymentNumbers.nagad;
    const methodName = m === 'bkash' ? '‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂' : '‡¶®‡¶ó‡¶¶';
    content.innerHTML = `<div style="text-align: center; margin-bottom: 10px;"><span style="font-weight: bold;">${methodName}</span> ‡¶è ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡¶æ‡¶†‡¶ø‡¶Ø‡¶º‡ßá ID ‡¶ü‡¶ø ‡¶¶‡¶ø‡¶®</div><input type="text" class="trx-input" id="trxID" placeholder="Transaction ID"><ul class="instruction-list"><li>‡ßß. <span style="background:rgba(0,0,0,0.2); padding:2px 5px; border-radius:3px;">${dialCode}</span> ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</li><li>‡•®. <b>Send Money</b> ‡¶è ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞‡¶ü‡¶ø ‡¶¶‡¶ø‡¶®‡¶É <div class="copy-wrapper"><span id="agentNumber" style="font-size: 18px; font-weight: bold;">${merchantNum}</span><button onclick="copyNumber()" style="background: #fff; border:none; padding:3px 8px; border-radius:3px; cursor:pointer; font-size:12px; color:#333;">Copy</button></div></li><li>‡•©. ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£‡¶É <b>‡ß≥ ${totalAmount}</b></li><li>‡•™. Transaction ID ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</li></ul>`;
  }
}

function copyNumber() {
  navigator.clipboard.writeText(el("agentNumber").innerText);
  const toast = el("toast");
  toast.className = "show";
  setTimeout(() => toast.className = "",2000);
}

function handleAction() {
  proceedToFinalize();
}

function validatePaymentButton() {
  const btn = el('actionBtn');
  const trxInput = el('trxID');
  if(!selectedMethod) return;
  if(selectedMethod === 'cod') {
    btn.disabled = false;
  } else {
    btn.disabled = !trxInput || !trxInput.value.trim();
  }
}

function proceedToFinalize() {
  if(!selectedMethod) return;
  const trxInput = el('trxID');
  const trxId = trxInput ? trxInput.value.trim() : '';
  if(selectedMethod !== 'cod' && !trxId) {
    alert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá Transaction ID ‡¶¶‡¶ø‡¶®");
    return;
  }
  if(selectedMethod === 'cod') {
    const total = cart.reduce((s, p) => s + p.price, 0);
    if(el('confirm-total-display')) el('confirm-total-display').innerText = total;
    if(el('confirm-payment-display')) el('confirm-payment-display').innerText = 'Cash on Delivery';
    populateCheckoutForm();
    changeView('view-checkout');
  } else {
    updatePaymentUI();
    changeView('view-payment-info');
  }
}

function populateCheckoutForm() {
  if(firebaseInitialized && auth.currentUser) {
    db.ref(`users/${auth.currentUser.uid}`).once('value').then(snap => {
      const data = snap.val() || {};
      if(el('order-name')) el('order-name').value = data.name || '';
      if(el('order-phone')) el('order-phone').value = data.phone || '';
      if(el('order-address')) el('order-address').value = data.address || '';
    }).catch(e => console.log("Error populating form", e));
  }
}

async function submitOrderHandler() {
  const name = el('order-name')?.value.trim();
  const phone = el('order-phone')?.value.trim();
  const address = el('order-address')?.value.trim();
  const trxInput = el('trxID');
  const trxId = trxInput ? trxInput.value.trim() : '';

  if(!name || !phone || !address) return alert("‡¶∏‡¶¨ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®");
  const phoneRegex = /^(?:\+88|88)?(01[3-9]\d{8})$/;
  if(!phoneRegex.test(phone)) return alert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡¶ø‡¶®");
  if(selectedMethod !== 'cod' && !trxId) return alert("Transaction ID ‡¶¶‡¶ø‡¶®");

  const order = {
    orderId: "ALB-" + Date.now(),
    customer: { name, phone, address, email: auth.currentUser?.email || 'guest@example.com' },
    items: cart,
    total: cart.reduce((s, p) => s + p.price, 0),
    payment: selectedMethod,
    trxId: trxId || 'COD',
    status: 'Pending',
    at: firebase.database.ServerValue.TIMESTAMP
  };

  try {
    if(firebaseInitialized) {
      await db.ref('orders').push(order);
    }
    alert("‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡¶´‡¶≤! ID: " + order.orderId);
    cart = [];
    syncCart();
    changeView('view-home');
    el('order-name').value = '';
    el('order-phone').value = '';
    el('order-address').value = '';
    if(trxInput) trxInput.value = '';
  } catch(e) {
    alert("‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•: " + e.message);
  }
}

async function handleSignup() {
  if(!firebaseInitialized) return alert("Internet connection required");
  const name = el('signup-name').value.trim();
  const email = el('signup-email').value.trim();
  const phone = el('signup-phone').value.trim();
  const pass = el('signup-password').value;
  const confirm = el('signup-confirm-password').value;

  if(!name || !email || !phone || !pass) return alert("Fill all fields");
  if(pass !== confirm) return alert("Passwords mismatch");
  if(pass.length < 6) return alert("Password too short");
  try {
    const cred = await auth.createUserWithEmailAndPassword(email, pass);
    await db.ref(`users/${cred.user.uid}`).set({ name, email, phone, address: '' });
    changeView('view-home');
  } catch(err) {
    alert("Error: " + err.message);
  }
}

async function handleLogin() {
  if(!firebaseInitialized) return alert("Internet connection required");
  try {
    await auth.signInWithEmailAndPassword(el('login-email').value.trim(), el('login-password').value);
    changeView('view-home');
  } catch(err) {
    alert("Login Failed: " + err.message);
  }
}

function logout() {
  if(auth) auth.signOut().then(() => {
    cart = [];
    syncCart();
    changeView('view-login');
  });
}

function checkAccountView() {
  const guestView = el('account-guest-view');
  const userView = el('account-user-view');
  if (firebaseInitialized && auth.currentUser) {
    guestView.classList.add('hidden');
    userView.classList.remove('hidden');
    loadUserProfile();
    loadOrders(auth.currentUser.email);
  } else {
    guestView.classList.remove('hidden');
    userView.classList.add('hidden');
  }
}

async function loadUserProfile() {
  if(!auth.currentUser) return;
  try {
    const snap = await db.ref(`users/${auth.currentUser.uid}`).once('value');
    const data = snap.val() || {};
    if(el('profile-name')) el('profile-name').value = data.name || '';
    if(el('profile-phone')) el('profile-phone').value = data.phone || '';
    if(el('profile-address')) el('profile-address').value = data.address || '';
    if(el('account-name')) el('account-name').innerText = data.name || 'User';
    if(el('user-email-display')) el('user-email-display').innerText = auth.currentUser.email || 'No email';
    if(el('avatar')) el('avatar').innerText = (auth.currentUser.email || '')[0].toUpperCase();
  } catch(e) {
    console.error("Error loading user profile:", e);
  }
}

async function updateProfile() {
  if(!auth.currentUser) return;
  const name = el('profile-name').value.trim();
  const phone = el('profile-phone').value.trim();
  const address = el('profile-address').value.trim();

  if(!name || !phone || !address) return alert("Fill all fields");
  try {
    await db.ref(`users/${auth.currentUser.uid}`).update({ name, phone, address });
    alert("Updated!");
    if(el('account-name')) el('account-name').innerText = name;
  } catch(e) {
    alert("Error: " + e.message);
  }
}

async function loadOrders(email) {
  if(!firebaseInitialized) return;
  const list = el('order-list');
  if(!list) return;
  list.innerHTML = '<div class="text-center py-4 text-muted">Loading...</div>';
  try {
    const snap = await db.ref('orders').orderByChild('customer/email').equalTo(email).once('value');
    list.innerHTML = '';
    let totalSpent = 0, pending = 0, count = 0;
    snap.forEach(child => {
      const o = child.val();
      totalSpent += parseInt(o.total);
      if(o.status === 'Pending') pending++;
      count++;
      const statusClass = o.status === 'Pending' ? "bg-orange-100 text-orange-600" : o.status === 'Completed' ? "bg-green-100 text-green-600" : "bg-slate-100 text-slate-600";
      const date = new Date(o.at).toLocaleString('bn-BD', { year: 'numeric', month: 'short', day: 'numeric' });
      const itemHtml = o.items ? o.items.map(i => `<div class="text-sm text-muted">‚Ä¢ ${i.title} (${i.quantity||1}x)</div>`).join('') : '';
      list.innerHTML += `<div class="card p-4 rounded-2xl shadow-sm"><div class="flex justify-between items-start mb-2"><div><span class="font-bold text-sm">#${o.orderId.substr(-6)}</span><span class="text-[10px] px-2 py-0.5 rounded-full font-bold ${statusClass} ml-2">${o.status}</span></div><div class="text-right"><div class="font-bold text-[#d4af37]">‡ß≥${o.total}</div><div class="text-[10px] text-muted">${o.payment}</div></div></div><div class="text-[10px] text-muted">${date}</div><div class="mt-2">${itemHtml}</div></div>`;
    });
    if(el('stat-orders')) el('stat-orders').innerText = count;
    if(el('stat-pending')) el('stat-pending').innerText = pending;
    if(el('stat-spent')) el('stat-spent').innerText = totalSpent;
    if(count === 0) list.innerHTML = '<div class="text-center py-8 text-muted">‡¶ï‡ßã‡¶®‡ßã ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶®‡ßá‡¶á</div>';
  } catch(e) {
    list.innerHTML = '<div class="text-center py-8 text-red-500">Error loading orders</div>';
  }
}

function showChangePassword() {
  el('password-modal').classList.add('show');
}

function hideChangePassword() {
  el('password-modal').classList.remove('show');
}

async function changePassword() {
  if(!auth.currentUser) return;
  const oldP = el('old-pass').value;
  const newP = el('new-pass').value;
  const confirmP = el('confirm-pass').value;

  if(!oldP || !newP || !confirmP) return alert("Fill all fields");
  if(newP !== confirmP) return alert("Mismatch");
  try {
    const cred = firebase.auth.EmailAuthProvider.credential(auth.currentUser.email, oldP);
    await auth.currentUser.reauthenticateWithCredential(cred);
    await auth.currentUser.updatePassword(newP);
    alert("Password changed!");
    hideChangePassword();
  } catch(e) {
    alert("Failed: " + e.message);
  }
}

function syncCart() {
  localStorage.setItem('alb_cart', JSON.stringify(cart));
  const badge = el('cart-badge');
  const list = el('cart-items');
  const summary = el('cart-summary');
  const empty = el('cart-empty');
  if(badge) badge.innerText = cart.length;

  if(cart.length > 0) {
    if(summary) summary.classList.remove('hidden');
    if(empty) empty.classList.add('hidden');
    let total = 0;
    if(list) {
      list.innerHTML = cart.map((p, i) => {
        total += p.price;
        return `<div class="flex items-center gap-4 card p-4 rounded-2xl"><img src="${p.img}" class="w-16 h-16 rounded-xl object-cover"><div class="flex-1"><h6 class="font-bold text-sm">${p.title}</h6><p class="text-[#d4af37] font-bold">‡ß≥${p.price}</p></div><button class="remove-item-btn text-red-400 w-6 h-6 rounded-full flex items-center justify-center" data-index="${i}">‚úï</button></div>`;
      }).join('');
    }
    if(el('cart-total')) el('cart-total').innerText = total;
  } else {
    if(summary) summary.classList.add('hidden');
    if(empty) empty.classList.remove('hidden');
    if(list) list.innerHTML = "";
    if(el('cart-total')) el('cart-total').innerText = "0";
  }
}

function addToCart(id) {
  const p = products.find(x => x.id == id);
  if(p) {
    cart.push({...p});
    syncCart();
  }
}

function removeItem(i) {
  cart.splice(i, 1);
  syncCart();
}

function initPremiumSlider() {
  const container = el('slider-container');
  const dots = el('slider-dots');
  if(!container || !dots || premiumSlides.length === 0) return;

  container.innerHTML = premiumSlides.map((s, i) => `<div class="slider-slide"><img src="${s.image}" class="slider-image"><div class="slider-overlay"><div class="slider-title">${s.title}</div><div class="slider-subtitle">${s.subtitle}</div></div></div>`).join('');
  dots.innerHTML = premiumSlides.map((_, i) => `<div class="slider-dot ${i===0?'active':''}" data-index="${i}"></div>`).join('');
  if(sliderInterval) clearInterval(sliderInterval);
  sliderInterval = setInterval(goToNextSlide, 5000);
}

function goToSlide(index) {
  const container = el('slider-container');
  if(!container) return;
  currentSlideIndex = index;
  container.style.transform = `translateX(-${index * 100}%)`;
  document.querySelectorAll('.slider-dot').forEach((d, i) => d.classList.toggle('active', i === index));
}

function goToNextSlide() {
  currentSlideIndex = (currentSlideIndex + 1) % premiumSlides.length;
  goToSlide(currentSlideIndex);
}

function goToPrevSlide() {
  currentSlideIndex = (currentSlideIndex - 1 + premiumSlides.length) % premiumSlides.length;
  goToSlide(currentSlideIndex);
}

function renderProducts() {
  const container = el('product-container');
  if(!container) return;
  if(products.length === 0) {
    container.innerHTML = '<p class="text-center col-span-2 py-10 text-muted">No products</p>';
    return;
  }
  container.innerHTML = products.map(p => `<div class="card overflow-hidden shadow-sm cursor-pointer product-item" data-id="${p.id}"><img src="${p.img}" class="w-full aspect-square object-cover"><div class="p-3"><h5 class="text-[12px] font-bold h-8 overflow-hidden">${p.title}</h5><div class="flex justify-between items-center mt-2"><span class="text-[#d4af37] font-extrabold">‡ß≥${p.price}</span><button class="add-to-cart-btn bg-[#1e293b] text-white w-7 h-7 rounded-full text-lg flex items-center justify-center" data-id="${p.id}">+</button></div></div></div>`).join('');
}

function openProduct(id) {
  const p = products.find(x => x.id == id);
  if(!p) return;
  const detailContent = el('detail-content');
  if(detailContent) {
    detailContent.innerHTML = `<img src="${p.img}" class="w-full rounded-3xl mb-6 shadow-xl"><h1 class="text-2xl font-extrabold">${p.title}</h1><p class="text-[#d4af37] text-2xl font-extrabold my-2">‡ß≥${p.price}</p><div class="bg-[#f1f5f9] dark:bg-[#334155] px-4 py-2 rounded-xl text-[10px] inline-block mb-6 font-bold uppercase">SKU: ALB-${p.id}</div><h4 class="font-bold mb-2">‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£:</h4><p class="text-muted text-sm mb-8 leading-relaxed">${p.desc}</p><button class="add-to-cart-detail-btn btn-primary w-full" data-id="${p.id}">‡¶¨‡ßç‡¶Ø‡¶æ‡¶ó‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>`;
  }
  changeView('view-detail');
}

function toggleTheme() {
  document.body.classList.toggle('dark');
}

window.addEventListener('beforeunload', () => { if(sliderInterval) clearInterval(sliderInterval); });
</script>
</body>
</html>